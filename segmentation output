
THE DICE OUTPUT (FOR SEGMENTATION)
C:\Users\asyao\PycharmProjects\CHESTXRAY_DEEPLEARNING\.venv1\Scripts\python.exe C:\Users\asyao\PycharmProjects\ProjectULT-AI\UNET_OPTIMIZATION.py
CWD: C:\Users\asyao\PycharmProjects\ProjectULT-AI
Using device: cuda
Using 5 mask channels for both datasets
Dataset initialized with 452 images and 5 mask channels
Dataset initialized with 130 images and 5 mask channels
Batch 0:
  Images shape: torch.Size([4, 1, 224, 224]), range: [-1.000, -0.992]
  Masks shape: torch.Size([4, 5, 224, 224]), range: [0.000, 1.000]
  Mask channel 0: coverage 0.0556
  Mask channel 1: coverage 0.0000
  Mask channel 2: coverage 0.0000
  Mask channel 3: coverage 0.0000
  Mask channel 4: coverage 0.0000
Batch 1:
  Images shape: torch.Size([4, 1, 224, 224]), range: [-1.000, -0.992]
  Masks shape: torch.Size([4, 5, 224, 224]), range: [0.000, 1.000]
  Mask channel 0: coverage 0.0516
  Mask channel 1: coverage 0.0000
  Mask channel 2: coverage 0.0000
  Mask channel 3: coverage 0.0000
  Mask channel 4: coverage 0.0000
Data verification complete.
Phase 1: Freeze encoder, train decoder
C:\Users\asyao\PycharmProjects\CHESTXRAY_DEEPLEARNING\.venv1\Lib\site-packages\torch\optim\lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1/5 - Train Loss: 1.5750, Train Dice: 0.0693 | Val Loss: 1.4439, Val Dice: 0.1875
Epoch 2/5 - Train Loss: 1.3597, Train Dice: 0.2073 | Val Loss: 1.2616, Val Dice: 0.3924
Epoch 3/5 - Train Loss: 1.2114, Train Dice: 0.3668 | Val Loss: 1.1624, Val Dice: 0.7197
Epoch 4/5 - Train Loss: 1.1307, Train Dice: 0.6509 | Val Loss: 1.0921, Val Dice: 0.7758
Epoch 5/5 - Train Loss: 1.0836, Train Dice: 0.7298 | Val Loss: 1.0597, Val Dice: 0.8717
Phase 2: Unfreeze encoder, fine-tune full model
Epoch 6/50 - Train Loss: 1.0618, Train Dice: [0.3974939960557803, 0.9889380530973452, 0.9446902881681392, 1.0, 0.7057522340158445] | Val Loss: 1.0548, Val Dice: [0.4521054250724388, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.97727273088513]
Epoch 7/50 - Train Loss: 1.0531, Train Dice: [0.44560377504182075, 0.9889380530973452, 0.9690265634418589, 0.997787612729368, 0.7300885203665337] | Val Loss: 1.0588, Val Dice: [0.44458942566857196, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 8/50 - Train Loss: 1.0435, Train Dice: [0.4903813688892179, 0.9889380530973452, 0.9867256668816625, 1.0, 0.7566372071747232] | Val Loss: 1.0428, Val Dice: [0.46672429279847577, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 9/50 - Train Loss: 1.0380, Train Dice: [0.4974925278694229, 0.9889380530973452, 0.986725667936612, 1.0, 0.8075222125095604] | Val Loss: 1.0166, Val Dice: [0.563179303299297, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 10/50 - Train Loss: 1.0282, Train Dice: [0.5430154758217061, 0.9889380530973452, 0.9867256663541878, 1.0, 0.9026549310810799] | Val Loss: 1.0287, Val Dice: [0.4962538110487389, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 11/50 - Train Loss: 1.0201, Train Dice: [0.5386673019523114, 0.9889380530973452, 0.9889380552072441, 1.0, 0.9336283618369988] | Val Loss: 1.0069, Val Dice: [0.6091164662079378, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9848484848484849]
Epoch 12/50 - Train Loss: 1.0118, Train Dice: [0.5744842285603549, 0.9889380530973452, 0.9889380536248199, 1.0, 0.9668141814459742] | Val Loss: 1.0021, Val Dice: [0.5985572211670153, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9848484848484849]
Epoch 13/50 - Train Loss: 1.0042, Train Dice: [0.5922718514910842, 0.9889380530973452, 0.9889380552072441, 1.0, 0.9867256700465109] | Val Loss: 0.9897, Val Dice: [0.6259648736679193, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 14/50 - Train Loss: 0.9964, Train Dice: [0.6039739173334256, 0.9889380530973452, 0.9911504424778761, 1.0, 0.993362836078205] | Val Loss: 0.9898, Val Dice: [0.617718368768692, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9848484920732903]
Epoch 15/50 - Train Loss: 0.9895, Train Dice: [0.6058055017374259, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9804, Val Dice: [0.6270237461184011, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9848484848484849]
Epoch 16/50 - Train Loss: 0.9849, Train Dice: [0.6136261195735594, 0.9889380530973452, 0.9911504424778761, 1.0, 0.9977876116744185] | Val Loss: 0.9798, Val Dice: [0.6102153207316543, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 17/50 - Train Loss: 0.9782, Train Dice: [0.6139343634115911, 0.9889380530973452, 0.9889380552072441, 1.0, 0.9977876111469438] | Val Loss: 0.9675, Val Dice: [0.6059829132123427, 0.9924242424242424, 0.9772727417223381, 0.9924242424242424, 0.9772727417223381]
Epoch 18/50 - Train Loss: 0.9680, Train Dice: [0.6346830058414324, 0.9889380530973452, 0.9867256668816625, 1.0, 0.997787612729368] | Val Loss: 0.9692, Val Dice: [0.5807558803847341, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 19/50 - Train Loss: 0.9592, Train Dice: [0.667267785399361, 0.9889380530973452, 0.9889380552072441, 1.0, 1.0] | Val Loss: 0.9555, Val Dice: [0.6477142924612219, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 20/50 - Train Loss: 0.9566, Train Dice: [0.6560271379694474, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9637, Val Dice: [0.6370745427680738, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 21/50 - Train Loss: 0.9537, Train Dice: [0.6549807837051628, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9507, Val Dice: [0.6563624613212816, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 22/50 - Train Loss: 0.9497, Train Dice: [0.6582008700455184, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9558, Val Dice: [0.6191585556124196, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 23/50 - Train Loss: 0.9440, Train Dice: [0.6770521531590318, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9472, Val Dice: [0.6599600278969967, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 24/50 - Train Loss: 0.9374, Train Dice: [0.6905102363202424, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9521, Val Dice: [0.5559675065856992, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 25/50 - Train Loss: 0.9374, Train Dice: [0.67928766070214, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9382, Val Dice: [0.6297630586407401, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 26/50 - Train Loss: 0.9344, Train Dice: [0.6836518289241116, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9406, Val Dice: [0.6524518881783341, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 27/50 - Train Loss: 0.9290, Train Dice: [0.7007648422654751, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9467, Val Dice: [0.6434177923383135, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 28/50 - Train Loss: 0.9282, Train Dice: [0.6937675241347963, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9448, Val Dice: [0.5588591369715604, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 29/50 - Train Loss: 0.9232, Train Dice: [0.7125075135083325, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9270, Val Dice: [0.6644376218318939, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 30/50 - Train Loss: 0.9241, Train Dice: [0.7014045596650217, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9222, Val Dice: [0.6736304723855221, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 31/50 - Train Loss: 0.9187, Train Dice: [0.7178595825634172, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9274, Val Dice: [0.6565891463648189, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 32/50 - Train Loss: 0.9141, Train Dice: [0.7289156373095723, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9236, Val Dice: [0.6645913665944879, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 33/50 - Train Loss: 0.9136, Train Dice: [0.7255130096346931, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9228, Val Dice: [0.6675062188596437, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 34/50 - Train Loss: 0.9133, Train Dice: [0.7278194335182157, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9204, Val Dice: [0.6803411064725934, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 35/50 - Train Loss: 0.9052, Train Dice: [0.7488584331179087, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9135, Val Dice: [0.6921435684868784, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 36/50 - Train Loss: 0.9081, Train Dice: [0.7364780058902977, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9198, Val Dice: [0.6550401530482552, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 37/50 - Train Loss: 0.9019, Train Dice: [0.7511749937471035, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9225, Val Dice: [0.6543235616250471, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 38/50 - Train Loss: 0.9015, Train Dice: [0.7527465358772109, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9144, Val Dice: [0.668615428335739, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 39/50 - Train Loss: 0.9023, Train Dice: [0.7479206782526675, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9160, Val Dice: [0.6656524538993835, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 40/50 - Train Loss: 0.8962, Train Dice: [0.765280694560667, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9178, Val Dice: [0.6449249558376543, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 41/50 - Train Loss: 0.8977, Train Dice: [0.7578117240846685, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9124, Val Dice: [0.6798044127045255, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 42/50 - Train Loss: 0.8919, Train Dice: [0.7747592923388017, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9140, Val Dice: [0.6623359277392878, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 43/50 - Train Loss: 0.8894, Train Dice: [0.7863717395647437, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9080, Val Dice: [0.6905492029406808, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 44/50 - Train Loss: 0.8909, Train Dice: [0.7763579735713723, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9061, Val Dice: [0.6951196193695068, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 45/50 - Train Loss: 0.8884, Train Dice: [0.7882256423477578, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9048, Val Dice: [0.7009713134982369, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 46/50 - Train Loss: 0.8884, Train Dice: [0.7801020831133412, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9056, Val Dice: [0.7026641856540333, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 47/50 - Train Loss: 0.8867, Train Dice: [0.7900289397324081, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9038, Val Dice: [0.7115271001151113, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 48/50 - Train Loss: 0.8863, Train Dice: [0.7861291460231342, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9011, Val Dice: [0.7135545674598578, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 49/50 - Train Loss: 0.8869, Train Dice: [0.7854321256148077, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9076, Val Dice: [0.6978033618493513, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
Epoch 50/50 - Train Loss: 0.8851, Train Dice: [0.7892766473567592, 0.9889380530973452, 0.9911504424778761, 1.0, 1.0] | Val Loss: 0.9036, Val Dice: [0.701187318021601, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424, 0.9924242424242424]
plot saved to training_progress.png
Training completed. Best validation Dice: 0.9367

Process finished with exit code 0
